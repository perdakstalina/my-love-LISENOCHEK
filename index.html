<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üíñ K–≤–µ—Å—Ç üíñ</title>
  <style>
    /* ======== –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ ======== */
    body {
      margin: 0;
      padding: 0;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: #ffe4eb; /* –Ω–µ–∂–Ω–æ-—Ä–æ–∑–æ–≤—ã–π —Ñ–æ–Ω */
    }
    h1, h2, h3, p {
      text-align: center;
      margin: 0 0 10px 0;
      color: #d14b77; /* –±–æ–ª–µ–µ —Ç—ë–º–Ω–æ-—Ä–æ–∑–æ–≤—ã–π —Ü–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ */
    }
    a, button, input, label {
      font-family: inherit;
    }

    /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä */
    .container {
      max-width: 700px;
      margin: 0 auto;
      padding: 20px;
    }

    /* –°–µ–∫—Ü–∏—è –∏–≥—Ä—ã (–ø–∞–Ω–µ–ª—å–∫–∞) */
    .game-section {
      background: #fff9fb; /* –ø–æ—á—Ç–∏ –±–µ–ª—ã–π —Å —Ä–æ–∑–æ–≤–∞—Ç—ã–º –æ—Ç—Ç–µ–Ω–∫–æ–º */
      border-radius: 20px;
      box-shadow: 0 0 15px rgba(221,135,164,0.3);
      padding: 20px;
      margin-bottom: 20px;
      position: relative;
    }
    .game-section::before, .game-section::after {
      content: "‚ù§";
      color: #ffa6c9;
      font-size: 24px;
      position: absolute;
    }
    .game-section::before {
      top: 10px; 
      left: 15px;
    }
    .game-section::after {
      bottom: 10px; 
      right: 15px;
    }

    /* –°–∫—Ä—ã—Ç–∏–µ –±–ª–æ–∫–æ–≤ */
    .hidden {
      display: none;
    }

    /* –ö–Ω–æ–ø–∫–∏ */
    button {
      background-color: #ff8fb1; 
      color: #fff;
      border: none;
      border-radius: 20px;
      font-size: 16px;
      cursor: pointer;
      padding: 10px 30px;
      margin: 10px auto 0 auto; 
      display: inline-block; /* —á—Ç–æ–±—ã —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å */
      transition: background-color 0.2s;
    }
    button:hover {
      background-color: #ffacc9;
    }

    /* –¢–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–ª—è */
    input[type="text"], input[type="number"] {
      border: 1px solid #ffadc1;
      border-radius: 10px;
      padding: 5px 10px;
      font-size: 14px;
      width: 200px;
      outline: none;
      margin: 10px 0;
      text-align: center;
    }
    input[type="text"]:focus, input[type="number"]:focus {
      box-shadow: 0 0 3px #ffa6c9;
    }

    /* –ë–ª–æ–∫–∏ —Å –±—É–∫–≤–∞–º–∏ (–∞–Ω–∞–≥—Ä–∞–º–º–∞) */
    .letters {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      margin: 10px 0;
    }
    .letter {
      margin: 5px;
      padding: 10px 15px;
      background-color: #ffeaf0;
      font-weight: bold;
      cursor: pointer;
      border-radius: 10px;
      border: 1px solid #ffc6d6;
      color: #d14b77;
    }
    .letter:hover {
      background-color: #ffd7e3;
    }

    /* –°–µ—Ç–∫–∞ –¥–ª—è –∏–≥—Ä—ã "–ø–∞—Ä—ã" */
    .memory-grid {
      display: grid;
      grid-template-columns: repeat(4, 100px);
      grid-gap: 10px;
      justify-content: center;
      margin-top: 15px;
    }
    .memory-card {
      width: 100px;
      height: 100px;
      background-color: #ffeaf0;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      border-radius: 10px;
      font-size: 14px;
      text-align: center;
      word-wrap: break-word;
      border: 1px solid #ffc6d6;
      color: #d14b77;
      transition: background-color 0.2s;
    }
    .memory-card.flipped {
      background-color: #ff8fb1;
      color: #fff;
    }
    .memory-card.matched {
      background-color: #ffeaf0;
      color: #c5c5c5;
      border: 1px dashed #ffc6d6;
      cursor: default;
    }

    /* –ê–¥–∞–ø—Ç–∞—Ü–∏—è —Å–µ—Ç–∫–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
    @media (max-width: 600px) {
      .memory-grid {
        grid-template-columns: repeat(2, 100px);
      }
    }

    /* –î–ª—è –≤–∏—Å–µ–ª–∏—Ü—ã (Hangman) */
    .hangman-wrapper {
      text-align: center;
      margin-top: 20px;
    }
    .hangman-word {
      font-size: 24px;
      margin: 20px 0;
      min-height: 40px; 
      color: #d14b77; 
      word-break: break-word;
    }
    .alphabet {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      max-width: 400px;
      margin: 0 auto;
    }
    .alphabet button {
      width: 40px;
      margin: 5px;
      padding: 10px;
      font-size: 16px;
      border-radius: 10px;
      background-color: #ffeaf0;
      color: #d14b77;
      font-weight: bold;
      border: 1px solid #ffc6d6;
      transition: background-color 0.2s;
    }
    .alphabet button:hover {
      background-color: #ffd7e3;
    }
    .alphabet button.correct {
      background-color: #afffaf; /* —Å–≤–µ—Ç–ª–æ-–∑–µ–ª—ë–Ω—ã–π, –µ—Å–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É–≥–∞–¥–∞–ª–∏ */
      color: #1b771b; 
    }
    .alphabet button.wrong {
      background-color: #ffbfc9; /* –±–æ–ª–µ–µ –∫—Ä–∞—Å–Ω–æ–≤–∞—Ç—ã–π —Ä–æ–∑–æ–≤—ã–π –ø—Ä–∏ –æ—à–∏–±–∫–µ */
      color: #700f1f;
    }

    /* –§–∏–Ω–∞–ª, —É–∫—Ä–∞—à–µ–Ω–∏–µ */
    #final h3 {
      color: #d14b77;
    }

    /* –¢–µ–∫—Å—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */
    .result-text {
      color: #c94d7e; 
      font-weight: bold; 
      margin-top: 10px;
      text-align: center;
    }

    /* –ö–Ω–æ–ø–∫–∞ "–î–∞–ª–µ–µ" */
    .next-btn {
      display: none; /* –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∫—Ä—ã—Ç–∞ */
      margin-top: 20px;
    }
    .next-btn.show {
      display: inline-block;
    }

  </style>
</head>
<body>

<div class="container">

  <!-- –ê—É–¥–∏–æ –¥–ª—è –º—É–∑—ã–∫–∏ (—Ñ–æ–Ω–æ–≤–∞—è –º—É–∑—ã–∫–∞) -->
  <!-- –§–∞–π–ª music.mp3 –¥–æ–ª–∂–µ–Ω –ª–µ–∂–∞—Ç—å —Ä—è–¥–æ–º —Å index.html –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ -->
  <audio id="bg-music" src="music.mp3" preload="auto" loop></audio>
  
  <!-- –í—Å—Ç—É–ø–ª–µ–Ω–∏–µ -->
  <div id="intro" class="game-section">
    <h1> –†–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∫–≤–µ—Å—Ç </h1>
    <p>
      –ü—Ä–∏–≤–µ—Ç –º–æ–π –õ–∏—Å—ë–Ω–æ—á–µ–∫, –≤ —ç—Ç–æ—Ç —Ä–∞–∑ —è —Ä–µ—à–∏–ª —Å–¥–µ–ª–∞—Ç—å —á—Ç–æ-—Ç–æ –µ—â—ë –±–æ–ª–µ–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ –∏ –æ—Å–æ–±–æ–µ, —Ö–æ—á—É –ø—Ä–æ—Å—Ç–æ, —á—Ç–æ–± —Ç–≤–æ—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –±—ã–ª–æ —Å–∞–º—ã–º —Å—á–∞—Å—Ç–ª–∏–≤—ã–º –∏ –¥–æ–±—Ä—ã–º! –ü–æ–º–∏–º–æ –∫–≤–µ—Å—Ç–æ–≤, —è –±—É–¥—É —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Ñ–∞–∫—Ç—ã. –ê –µ—â—ë —è –∑–Ω–∞—é, —á—Ç–æ —ç—Ç–æ –¥–ª—è —Ç–µ–±—è –æ—Å–æ–±–µ–Ω–Ω—ã–π —Ç—Ä–µ–∫, —Ç–∞–∫ –ø—É—Å–∫–∞–π –æ–Ω –∏ –±—É–¥–µ—Ç –∏–≥—Ä–∞—Ç—å (–Ω–∞–∂–º–∏ –∫–Ω–æ–ø–æ—á–∫—É –≤–∫–ª—é—á–∏—Ç—å –º—É–∑—ã–∫—É) –∏ —Å–ª—É—à–∞—è –µ–≥–æ —Ç—ã –±—É–¥–µ—à—å –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ —ç—Ç–æ –ø–æ-–Ω–∞—Å—Ç–æ—è—â–µ–º—É –ª—é–±–æ–≤—å‚ù§Ô∏è
    </p>
    <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –º—É–∑—ã–∫–∏ -->
    <button onclick="startMusic()">–í–∫–ª—é—á–∏—Ç—å –º—É–∑—ã–∫—É</button>
    <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã -->
    <button onclick="startGame()">‚ù§Ô∏è –ù–∞—á–∞—Ç—å –∏–≥—Ä—É ‚ù§Ô∏è</button>
  </div>

  <!-- –ò–≥—Ä–∞ 1: –ê–Ω–∞–≥—Ä–∞–º–º—ã (–≤—ã–¥–∞—ë—Ç —á–∞—Å—Ç—å 1) -->
  <div id="game1" class="game-section hidden">
    <h2>üíû –ò–≥—Ä–∞ 1: –ê–Ω–∞–≥—Ä–∞–º–º–∞ üíû</h2>
    <p>–°–æ–±–µ—Ä–∏ —Ñ—Ä–∞–∑—É –∏–∑ –ø–µ—Ä–µ–º–µ—à–∞–Ω–Ω—ã—Ö –±—É–∫–≤:</p>
    <div id="anagram-letters" class="letters"></div>
    <input type="text" id="anagram-answer" placeholder="–í–≤–µ–¥–∏ –æ—Ç–≤–µ—Ç" />
    <br/>
    <button onclick="checkAnagram()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
    <p id="anagram-result" class="result-text"></p>
    <p id="anagram-part" class="result-text"></p>
    <button id="anagram-next" class="next-btn" onclick="toGame2()">–î–∞–ª–µ–µ</button>
  </div>

  <!-- –ò–≥—Ä–∞ 2: –®–∏—Ñ—Ä –¶–µ–∑–∞—Ä—è (–≤—ã–¥–∞—ë—Ç —á–∞—Å—Ç—å 2) -->
  <div id="game2" class="game-section hidden">
    <h2>üíû –ò–≥—Ä–∞ 2: –®–∏—Ñ—Ä –¶–µ–∑–∞—Ä—è üíû</h2>
    <p>–†–∞—Å—à–∏—Ñ—Ä—É–π —Å–ª–µ–¥—É—é—â—É—é —á–∞—Å—Ç—å –ø–æ—Å–ª–∞–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É–π —Å–¥–≤–∏–≥)</p>
    <p id="cipher-text" style="text-align:center; font-weight:bold; font-size:18px; color:#d14b77;"></p>
    <div style="text-align:center;">
      <label for="cipher-shift" style="color:#d14b77;">–°–¥–≤–∏–≥: </label>
      <input type="number" id="cipher-shift" value="1" />
      <button onclick="decodeCaesar()">–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å</button>
    </div>
    <p id="cipher-result" class="result-text"></p>
    <p id="cipher-part" class="result-text"></p>
    <button id="cipher-next" class="next-btn" onclick="toGame3()">–î–∞–ª–µ–µ</button>
  </div>

  <!-- –ò–≥—Ä–∞ 3: –ü–∞—Ä—ã (–≤—ã–¥–∞—ë—Ç —á–∞—Å—Ç—å 3) -->
  <div id="game3" class="game-section hidden">
    <h2>üíû –ò–≥—Ä–∞ 3: –ü–∞—Ä—ã (Memory) üíû</h2>
    <p>–ù–∞–π–¥–∏ –≤—Å–µ –ø–∞—Ä—ã —Å–ª–æ–≤, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å —Ç—Ä–µ—Ç—å—é —á–∞—Å—Ç—å –ø–æ—Å–ª–∞–Ω–∏—è, —Ç–æ–ª—å–∫–æ –Ω–µ —Ç–æ—Ä–æ–ø–∏—Å—å –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ –∏ –Ω–µ –∫–ª–∏–∞–π –±—ã—Å—Ç—Ä–æ –Ω–∞ –∫–≤–∞–¥—Ä–∞—Ç–∏–∫–∏ (–æ–Ω–∏ –º–æ–≥—É—Ç –ø–æ–ª–æ–º–∞—Ç—å—Å—èüòÖ).</p>
    <div class="memory-grid" id="memory-grid"></div>
    <p id="memory-message" class="result-text"></p>
    <p id="memory-part" class="result-text"></p>
    <button id="memory-next" class="next-btn" onclick="toGame4()">–î–∞–ª–µ–µ</button>
  </div>

  <!-- –ò–≥—Ä–∞ 4: –í–∏—Å–µ–ª–∏—Ü–∞ (Hangman) (–≤—ã–¥–∞—ë—Ç —á–∞—Å—Ç—å 4) -->
  <div id="game4" class="game-section hidden">
    <h2>üíû –ò–≥—Ä–∞ 4: –í–∏—Å–µ–ª–∏—Ü–∞ üíû</h2>
    <p>–£–≥–∞–¥–∞–π –ø–æ—Å–ª–µ–¥–Ω—é—é —á–∞—Å—Ç—å —Ñ—Ä–∞–∑—ã! –°–ª–æ–≤–∞ —É–∂–µ —Ä–∞–∑–¥–µ–ª–µ–Ω—ã, –≤–∏–¥–µ–Ω —Ä–∞–∑–º–µ—Ä –∫–∞–∂–¥–æ–≥–æ.</p>
    <div class="hangman-wrapper">
      <div>
        <p id="hangman-hint"></p>
        <button onclick="showHangmanHint()">–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É</button>
      </div>
      <div id="hangman-word" class="hangman-word"></div>
      <p id="hangman-lives" style="color:#d14b77; font-weight:bold;"></p>
      <p id="hangman-extra-info" style="color:#c94d7e;"></p>
      <div class="alphabet" id="hangman-alphabet"></div>
      <p id="hangman-result" class="result-text"></p>
      <p id="hangman-part" class="result-text"></p>
      <button id="hangman-next" class="next-btn" onclick="toFinal()">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ–ª–Ω–æ–µ –ø–æ—Å–ª–∞–Ω–∏–µ</button>
    </div>
  </div>

  <!-- –§–∏–Ω–∞–ª: —Å–æ–±—Ä–∞–Ω–Ω–∞—è —Ñ—Ä–∞–∑–∞ -->
  <div id="final" class="game-section hidden">
    <h2>–ü–æ–∑–¥—Ä–∞–≤–ª—è—é —Ç—ã —Ä–∞–∑–≥–∞–¥–∞–ª–∞ –≤—Å–µ —Å–ª–æ–≤–∞!</h2>
    <p>–í–æ—Ç –º–æ—ë –ø–æ–ª–Ω–æ–µ –ø–æ—Å–ª–∞–Ω–∏–µ –¥–ª—è —Ç–µ–±—è:</p>
    <p id="final-message" style="font-size:18px; font-weight:bold; text-align:center; color:#c94d7e;"></p>
    <h3>–í —ç—Ç–æ–º –∫–≤–µ—Å—Ç–µ –º–Ω–µ –ø—Ä–æ—Å—Ç–æ –∑–∞—Ö–æ—Ç–µ–ª–æ—Å—å –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Ñ–∞–∫—Ç–∞–º–∏, –ø–æ—á–µ–º—É —Ç—ã –æ—Å–æ–±–∞—è –¥–ª—è –º–µ–Ω—è, –ø–æ—á–µ–º—É —è —Ç–µ–±—è –±—É–¥—É —Ü–µ–Ω–∏—Ç—å –∏ –ª—é–±–∏—Ç—å –≤—Å—é –∂–∏–∑–Ω—å! –ò –ø—Ä–æ—Å—Ç–æ –¥–∞—Ç—å —Ç–µ–±–µ —Ç—ë–ø–ª—ã—Ö —ç–º–æ—Ü–∏–π –∏ –≤–ø—Ä–µ–¥—å —è —Ç–æ–ª—å–∫–æ –∏ –±—É–¥—É –¥–µ–ª–∞—Ç—å –≤—Å—ë —Ç–æ, —á—Ç–æ —Ç–µ–±–µ –±—É–¥–µ—Ç –ø–æ–¥–Ω–∏–º–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ, –±—É–¥—É –æ–±–µ—Ä–µ–≥–∞—Ç—å —Ç–µ–±—è –∏ —Ü–µ–Ω–∏—Ç—å! –°–ø–∞—Å–∏–±–æ, —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏–ª–∞ –º–Ω–µ —Å—Ç–∞—Ç—å –ª—é–±–∏–º—ã–º —á–µ–ª–æ–≤–µ–∫–æ–º –≤ —Ç–≤–æ–µ–π –∂–∏–∑–Ω–∏! –Ø —Ç–µ–±—è —Å–∏–ª—å–Ω–æ –ª—é–±–ª—é! ‚ù§Ô∏è</h3>
  </div>
</div>

<script>
  // ========================================
  //              –û–ë–©–ò–ï
  // ========================================
  // –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—Ä–∞–∑–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞ 4 —á–∞—Å—Ç–∏
  const finalParts = [
    "–Ø –¢–ï–ë–Ø –õ–Æ–ë–õ–Æ",
    "–ó–ê –¢–í–û–ô –ü–û–¢–†–Ø–°–ê–Æ–©–ò–ô –•–ê–†–ê–ö–¢–ï–†",
    "–ó–ê –¢–û, –ß–¢–û –¢–´ –°–ê–ú–ê–Ø –£–ú–ù–ï–ù–¨–ö–ê–Ø",
    "–ò –ó–ê –¢–í–û–Æ –ü–†–ï–ö–†–ê–°–ù–£–Æ –í–ù–ï–®–ù–û–°–¢–¨"
  ];
  let collectedParts = ["", "", "", ""];

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –º—É–∑—ã–∫–∏ –ø–æ –Ω–∞–∂–∞—Ç–∏—é
  function startMusic() {
    const audio = document.getElementById('bg-music');
    // –ü—ã—Ç–∞–µ–º—Å—è –≤–∫–ª—é—á–∏—Ç—å –º—É–∑—ã–∫—É
    audio.play().catch(err => {
      console.log("–ê–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ:", err);
    });
  }

  // –ó–∞–ø—É—Å–∫
  function startGame() {
    document.getElementById("intro").classList.add("hidden");
    document.getElementById("game1").classList.remove("hidden");
    initAnagramGame();
  }

  // –ü–µ—Ä–µ—Ö–æ–¥—ã (–ø–æ –∫–Ω–æ–ø–∫–µ "–î–∞–ª–µ–µ")
  function toGame2() {
    document.getElementById("game1").classList.add("hidden");
    document.getElementById("game2").classList.remove("hidden");
    initCaesarGame();
  }
  function toGame3() {
    document.getElementById("game2").classList.add("hidden");
    document.getElementById("game3").classList.remove("hidden");
    initMemoryGame();
  }
  function toGame4() {
    document.getElementById("game3").classList.add("hidden");
    document.getElementById("game4").classList.remove("hidden");
    initHangmanGame();
  }
  function toFinal() {
    document.getElementById("game4").classList.add("hidden");
    document.getElementById("final").classList.remove("hidden");
    showFinalMessage();
  }

  // ========================================
  //      –ò–ì–†–ê 1: –ê–Ω–∞–≥—Ä–∞–º–º–∞ (–ß–∞—Å—Ç—å 1)
  // ========================================
  let anagramOriginal = finalParts[0]; 
  let anagramShuffled = shuffleArray(anagramOriginal.replace(/\s/g, '').split(''));

  function initAnagramGame() {
    let container = document.getElementById("anagram-letters");
    container.innerHTML = "";
    anagramShuffled.forEach(letter => {
      let span = document.createElement("span");
      span.textContent = letter;
      span.classList.add("letter");
      container.appendChild(span);
    });
  }

  function checkAnagram() {
    let answer = document.getElementById("anagram-answer").value
      .toUpperCase()
      .replace(/\s/g, '');
    let resultElem = document.getElementById("anagram-result");
    let partElem = document.getElementById("anagram-part");
    let nextBtn = document.getElementById("anagram-next");

    let correct = anagramOriginal.replace(/\s/g, '').toUpperCase();
    if (answer === correct) {
      resultElem.textContent = "–ú–æ–ª–æ–¥–µ—Ü, —ç—Ç–æ –±—ã–ª–æ –ø–æ –Ω–∞—Å—Ç–æ—è—â–µ–º—É –ª–µ–≥–∫–æ! –ê —Ç–µ–ø–µ—Ä—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç: –¢—ã –ø–µ—Ä–≤—ã–π —á–µ–ª–æ–≤–µ–∫ –≤ –º–æ–µ–π –∂–∏–∑–Ω–∏, —Ä–∞–¥–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ —è –≥–æ—Ç–æ–≤ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–∑–º–µ–Ω–∏—Ç—Å—è –∫–∞–∫ —Ç–µ–±–µ –±—É–¥–µ—Ç —É–≥–æ–¥–Ω–æ‚ù§Ô∏è";
      collectedParts[0] = finalParts[0];
      partElem.textContent = "–ü–æ–ª—É—á–µ–Ω–Ω–∞—è —á–∞—Å—Ç—å: " + finalParts[0];
      nextBtn.classList.add("show");
    } else {
      resultElem.textContent = "–ü–æ–∫–∞ –Ω–µ–≤–µ—Ä–Ω–æ, –ø–æ–ø—Ä–æ–±—É–π –µ—â—ë!";
    }
  }

  // ========================================
  //   –ò–ì–†–ê 2: –®–∏—Ñ—Ä –¶–µ–∑–∞—Ä—è (–ß–∞—Å—Ç—å 2)
  // ========================================
  const phrasePart2 = finalParts[1].toUpperCase();
  let shift2 = 5;
  let cipheredPart2 = caesarCipher(phrasePart2, shift2);

  function initCaesarGame() {
    document.getElementById("cipher-text").textContent = cipheredPart2;
  }

  function decodeCaesar() {
    let userShift = parseInt(document.getElementById("cipher-shift").value);
    let decoded = caesarCipher(cipheredPart2, -userShift);
    let resultElem = document.getElementById("cipher-result");
    let partElem = document.getElementById("cipher-part");
    let nextBtn = document.getElementById("cipher-next");

    if (decoded === phrasePart2) {
      resultElem.textContent = "–û—Ç–ª–∏—á–Ω–æ, –≤—Ç–æ—Ä—É—é —á–∞—Å—Ç—å —Ç—ã —É–∂–µ –ø–æ–ª—É—á–∏–ª–∞, –∞ —Ç–µ–ø–µ—Ä—å —Å–ª–µ–¥—É—é—â–∏–π –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç: —Ç—ã —Ç–æ—Ç —á–µ–ª–æ–≤–µ–∫, —á–µ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä –º–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –±–æ–ª—å—à–µ —á–µ–º –ª—é–±—ã–µ –¥—Ä—É–≥–∏–µ, —Ç–∞–∫–∏—Ö –∏—Å–∫—Ä–µ–Ω–Ω–∏—Ö –∏ –¥–æ–±—Ä—ã—Ö –ª—é–¥–µ–π –∫–∞–∫ —Ç—ã —è –µ—â—ë –Ω–µ –≤—Å—Ç—Ä–µ—á–∞–ª, –∏ —è –±–µ–∑—É–º–Ω–æ —Ä–∞–¥, —á—Ç–æ —Ç—ã —Ä–∏—Å–∫–Ω—É–ª–∞ ‚ù§Ô∏è ";
      partElem.textContent = "–ü–æ–ª—É—á–µ–Ω–Ω–∞—è —á–∞—Å—Ç—å: " + finalParts[1];
      nextBtn.classList.add("show");
    } else {
      resultElem.textContent = "–ù–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç... –¢–µ–∫—É—â–∏–π –≤–∞—Ä–∏–∞–Ω—Ç: " + decoded;
    }
  }

  // ========================================
  //   –ò–ì–†–ê 3: –ü–∞—Ä—ã (Memory) (–ß–∞—Å—Ç—å 3)
  // ========================================
  let memoryItems = [
    { text: "–°–ê–ú–ê–Ø",      pairId: 1 },
    { text: "–£–ú–ù–ï–ù–¨–ö–ê–Ø",  pairId: 2 },
    { text: "–¢–û",         pairId: 3 },
    { text: "–ß–¢–û",        pairId: 4 },
    { text: "–°–ê–ú–ê–Ø",      pairId: 1 },
    { text: "–£–ú–ù–ï–ù–¨–ö–ê–Ø",  pairId: 2 },
    { text: "–¢–û",         pairId: 3 },
    { text: "–ß–¢–û",        pairId: 4 },
  ];
  let firstCard = null;
  let secondCard = null;
  let matchedCount = 0;

  function initMemoryGame() {
    memoryItems = shuffleArray(memoryItems);
    matchedCount = 0;
    firstCard = null;
    secondCard = null;

    let grid = document.getElementById("memory-grid");
    grid.innerHTML = "";

    memoryItems.forEach((item, index) => {
      let card = document.createElement("div");
      card.classList.add("memory-card");
      card.dataset.index = index;
      card.dataset.pairId = item.pairId;
      card.innerText = "?";
      card.addEventListener("click", () => flipCard(card, item.text));
      grid.appendChild(card);
    });
    document.getElementById("memory-message").textContent = "";
    document.getElementById("memory-part").textContent = "";
    document.getElementById("memory-next").classList.remove("show");
  }

  function flipCard(card, text) {
    if (card.classList.contains("flipped") || card.classList.contains("matched")) return;
    card.classList.add("flipped");
    card.innerText = text;

    if (!firstCard) {
      firstCard = card;
    } else if (!secondCard && card !== firstCard) {
      secondCard = card;
      setTimeout(checkMatch, 700);
    }
  }

  function checkMatch() {
    let msgElem = document.getElementById("memory-message");
    let partElem = document.getElementById("memory-part");
    let nextBtn = document.getElementById("memory-next");

    if (firstCard.dataset.pairId === secondCard.dataset.pairId) {
      // –°–æ–≤–ø–∞–ª–æ
      firstCard.classList.remove("flipped");
      secondCard.classList.remove("flipped");
      firstCard.classList.add("matched");
      secondCard.classList.add("matched");
      matchedCount += 2;

      if (matchedCount === memoryItems.length) {
        msgElem.textContent = "–°—É–ø–µ–µ–µ—Ä! –ù–∞–¥–µ—é—Å—å —Ç–µ–±–µ –ø–æ–∫–∞ —á—Ç–æ –Ω—Ä–∞–≤–∏—Ç—Å—è –≤–µ—Å—å —ç—Ç–æ—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤—á–∏–∫, –≤–µ–¥—å —Å–æ –º–Ω–æ–π –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤ –≤ —Ç–≤–æ–µ–π –∂–∏–∑–Ω–∏ –±—É–¥–µ—Ç –≤—Å–µ–≥–¥–∞! –ê —Ç–µ–ø–µ—Ä—å –æ—á–µ—Ä–µ–¥–Ω–æ–π –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç: –¢—ã –ø–µ—Ä–≤—ã–π —á–µ–ª–æ–≤–µ–∫ –≤ –º–æ–µ–π –∂–∏–∑–Ω–∏, –∫–æ—Ç–æ—Ä–æ–≥–æ —è –ª—é–±–ª—é –Ω–∞—Å—Ç–æ–ª—å–∫–æ —Å–∏–ª—å–Ω–æ, —á—Ç–æ –ø–æ—Ä–æ–π –Ω–µ –º–æ–≥—É —Å–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Å–≤–æ–∏ —ç–º–æ—Ü–∏–∏ –∏ –ø–æ—ç—Ç–æ–º—É —è —á–∞—Å—Ç–æ –ø–∏—à—É –º–∏–ª—ã–µ —Ñ—Ä–∞–∑—ã —Ç–µ–±–µ, –¥–ª—è –º–µ–Ω—è —ç—Ç–æ –ø—Ä–æ—è–≤–ª–µ–Ω–∏–µ –∏—Å–∫—Ä–µ–Ω–Ω–∏—Ö —á—É–≤—Å—Ç–≤! –ê –≤—Å—ë –ø–æ—Ç–æ–º—É —á—Ç–æ —Ç—ã —Ö—Ä–∞–Ω–∏—à—å –≤ —Å–µ–±–µ —Å–∞–º—ã–µ –ª—É—á—à–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞, –∏ –æ–¥–Ω–æ –∏–∑ –Ω–∏—Ö, —ç—Ç–æ —Ç–æ, —á—Ç–æ —Ç—ã –ø–æ-–Ω–∞—Å—Ç–æ—è—â–µ–º—É —É–º–Ω–µ–Ω—å–∫–∞—è‚ù§Ô∏è";
        collectedParts[2] = finalParts[2];
        partElem.textContent = "–ü–æ–ª—É—á–µ–Ω–Ω–∞—è —á–∞—Å—Ç—å: " + finalParts[2];
        nextBtn.classList.add("show");
      }
    } else {
      // –ù–µ —Å–æ–≤–ø–∞–ª–æ
      firstCard.classList.remove("flipped");
      secondCard.classList.remove("flipped");
      firstCard.innerText = "?";
      secondCard.innerText = "?";
    }
    firstCard = null;
    secondCard = null;
  }

  // ========================================
  //   –ò–ì–†–ê 4: –í–∏—Å–µ–ª–∏—Ü–∞ (Hangman) (–ß–∞—Å—Ç—å 4)
  // ========================================
  const hangmanPhrase = finalParts[3].toUpperCase(); 
  let hangmanWords = hangmanPhrase.split(" "); 
  let hangmanWordsArray = hangmanWords.map(word => word.split(""));
  let revealedWordsArray = hangmanWordsArray.map(wordArr =>
    wordArr.map(char => (/[–ê-–Ø–Å]/.test(char) ? "_" : char))
  );
  let maxLives = 9; 
  let currentLives = maxLives;

  const totalLetters = hangmanPhrase.replace(/[^–ê-–Ø–Å]/g, "").length; 
  const wordsCount = hangmanWords.length;

  function initHangmanGame() {
    currentLives = maxLives;
    revealedWordsArray = hangmanWordsArray.map(wordArr =>
      wordArr.map(char => (/[–ê-–Ø–Å]/.test(char) ? "_" : char))
    );

    document.getElementById("hangman-word").textContent = renderHangman();
    document.getElementById("hangman-lives").textContent = 
      "–û—à–∏–±–æ–∫ –º–æ–∂–Ω–æ –¥–æ–ø—É—Å—Ç–∏—Ç—å: " + currentLives;
    document.getElementById("hangman-extra-info").textContent =
      `–ü–æ–¥—Å–∫–∞–∑–∫–∞ ‚Ññ1: –≤—Å–µ–≥–æ —Å–ª–æ–≤ - ${wordsCount}, –±—É–∫–≤ (–±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤) - ${totalLetters}.`;

    const rusAlphabet = "–ê–ë–í–ì–î–ï–Å–ñ–ó–ò–ô–ö–õ–ú–ù–û–ü–†–°–¢–£–§–•–¶–ß–®–©–™–´–¨–≠–Æ–Ø".split("");
    let alphabetDiv = document.getElementById("hangman-alphabet");
    alphabetDiv.innerHTML = "";

    rusAlphabet.forEach(letter => {
      let btn = document.createElement("button");
      btn.textContent = letter;
      btn.onclick = () => guessLetter(letter, btn);
      alphabetDiv.appendChild(btn);
    });

    document.getElementById("hangman-result").textContent = "";
    document.getElementById("hangman-hint").textContent = ""; 
    document.getElementById("hangman-part").textContent = "";
    document.getElementById("hangman-next").classList.remove("show");
  }

  function renderHangman() {
    return revealedWordsArray.map(wordArr => wordArr.join("")).join(" | ");
  }

  function showHangmanHint() {
    document.getElementById("hangman-hint").textContent = 
      "–ü–æ–¥—Å–∫–∞–∑–∫–∞ ‚Ññ2: –¢—É—Ç 5 —Å–ª–æ–≤, —á—Ç–æ–± —Ç–µ–±–µ –±—ã–ª–æ –ø–æ–Ω—è—Ç–Ω–µ–µ —Å–æ—Å—Ç–∞–≤—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏–∑ –≤—Å–µ—Ö –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Ä–µ–±—É—Å–æ–≤, –∞ —Ç–µ–ø–µ—Ä—å –∫ –ø–æ–¥—Å–∫–∞–∑–∫–µ: –≠—Ç–æ –∑–∞ —á—Ç–æ-—Ç–æ –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ–µ –≤ —Ç–µ–±–µ!";
  }

  function guessLetter(letter, btn) {
    if (btn.classList.contains("correct") || btn.classList.contains("wrong")) return;

    let foundAny = false;
    for (let w = 0; w < hangmanWordsArray.length; w++) {
      for (let c = 0; c < hangmanWordsArray[w].length; c++) {
        if (hangmanWordsArray[w][c] === letter) {
          revealedWordsArray[w][c] = letter;
          foundAny = true;
        }
      }
    }

    if (foundAny) {
      btn.classList.add("correct");
      document.getElementById("hangman-word").textContent = renderHangman();
      if (isAllRevealed()) {
        document.getElementById("hangman-result").textContent = "–ü–æ–∑–¥—Ä–∞–≤–ª—è—é! –¢—ã —É–≥–∞–¥–∞–ª–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é —á–∞—Å—Ç—å, –∏ –ø–æ —Ç—Ä–∞–¥–∏—Ü–∏–∏ –∫–≤–µ—Å—Ç–∞, –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç: —è –≤—Å–µ–≥–¥–∞ –≤—Å–µ–º –æ–ø–∏—Å—ã–≤–∞–ª –≤–Ω–µ—à–Ω–æ—Å—Ç—å —Å–≤–æ–µ–π –º–µ—á—Ç—ã –ø–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—é –∫ –¥–µ–≤—É—à–∫–∞–º –∫–∞–∫ —Ç–≤–æ—é, –º–Ω–µ –≤ —Ç–µ–±–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –∞–±—Å–æ–ª—é—Ç–Ω–æ –≤—Å—ë, –Ω–∞ —Ç–µ–±—è —è –≥–æ—Ç–æ–≤ —Å–º–æ—Ç—Ä–µ—Ç—å —á–∞—Å–∞–º–∏ –∏ –ø—Ä–æ—Å—Ç–æ –Ω–∞—Å–ª–∞–∂–¥–∞—Ç—å—Å—è, –≤ —Ç–µ–±–µ –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ –≤—Å—ë –æ—Ç —Ç–≤–æ–∏—Ö –≥–ª–∞–∑, –≤ –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ —Å–º–æ—Ç—Ä–µ—Ç—å –≤–µ—á–Ω–æ, –¥–æ –≤—Å–µ—Ö –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã—Ö –∏–∑–≥–∏–±–æ–≤ —Ç–µ–ª–∞, –ø—Ä–æ—Å—Ç–æ –∑–Ω–∞–π –≤—Å–µ–≥–¥–∞, —á—Ç–æ —Ç—ã —Å–∞–º–∞—è –ø—Ä–µ–∫—Ä–∞—Å–Ω–∞—è, –∏ —Ç—ã –õ–∏—Å—ë–Ω–æ—á–µ–∫ –º–æ–π –ª—é–±–∏–º—ã–π‚ù§Ô∏è ";
        collectedParts[3] = finalParts[3];
        document.getElementById("hangman-part").textContent = "–ü–æ–ª—É—á–µ–Ω–Ω–∞—è —á–∞—Å—Ç—å: " + finalParts[3];
        document.getElementById("hangman-next").classList.add("show");
      }
    } else {
      btn.classList.add("wrong");
      currentLives--;
      document.getElementById("hangman-lives").textContent = 
        "–û—à–∏–±–æ–∫ –º–æ–∂–Ω–æ –¥–æ–ø—É—Å—Ç–∏—Ç—å: " + currentLives;
      if (currentLives <= 0) {
        document.getElementById("hangman-result").textContent = 
          "–£–≤—ã, –ø–æ–ø—ã—Ç–∫–∏ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å! –ü–æ–ø—Ä–æ–±—É–π —Å–Ω–æ–≤–∞!";
        setTimeout(initHangmanGame, 1500);
      }
    }
  }

  function isAllRevealed() {
    for (let w = 0; w < revealedWordsArray.length; w++) {
      if (revealedWordsArray[w].includes("_")) {
        return false;
      }
    }
    return true;
  }

  // ========================================
  //              –§–ò–ù–ê–õ
  // ========================================
  function showFinalMessage() {
    let fullSentence = 
      collectedParts[0] + ", " + 
      collectedParts[1].toLowerCase() + ", " +
      collectedParts[2].toLowerCase() + ", " +
      collectedParts[3].toLowerCase() + "!";
    
    document.getElementById("final-message").textContent = fullSentence;
  }

  // ========================================
  //        –£–¢–ò–õ–ò–¢–´ (Shuffle / Caesar)
  // ========================================
  function shuffleArray(array) {
    let arr = array.slice();
    for (let i = arr.length - 1; i > 0; i--) {
      let j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
  }

  function caesarCipher(str, shift) {
    const alphabet = "–ê–ë–í–ì–î–ï–Å–ñ–ó–ò–ô–ö–õ–ú–ù–û–ü–†–°–¢–£–§–•–¶–ß–®–©–™–´–¨–≠–Æ–Ø";
    let result = "";
    let upperStr = str.toUpperCase();

    for (let i = 0; i < upperStr.length; i++) {
      let char = upperStr[i];
      let index = alphabet.indexOf(char);
      if (index === -1) {
        result += char; 
      } else {
        let newIndex = (index + shift) % alphabet.length;
        if (newIndex < 0) newIndex += alphabet.length;
        result += alphabet[newIndex];
      }
    }
    return result;
  }
</script>

</body>
</html>
